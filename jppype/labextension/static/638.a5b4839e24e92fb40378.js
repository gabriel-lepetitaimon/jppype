(self.webpackChunkjppype=self.webpackChunkjppype||[]).push([[638],{338:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.JView2DModel=t.layers_options_serializer=t.layers_data_serializer=t.JView2D=void 0;const s=n(4985),o=i(n(6271)),r=i(n(7187)),a=i(n(4456)),l=n(1210),c=n(6233),u=n(4368);class d extends l.JBaseWidget{render(){if(this.el.classList.add("custom-widget"),this.el.classList.add("maximizing-widget"),void 0===this.model)return;const e=o.default.createElement(r.default,{model:this.model,events:{onClick:e=>{this.send_event("onclick",{x:e.cursor.x,y:e.cursor.y,altKey:e.altKey,metaKey:e.metaKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,button:e.button})}}});a.default.render(e,this.el)}}t.JView2D=d;const h={_instance_id:0,_loading:!1,_layers_data:{},_layers_options:{},_domain:u.Rect.EMPTY,_transform:{center:u.Point.ORIGIN,zoom:0},_target_transform:{center:u.Point.ORIGIN,zoom:0},linkedTransform:null};t.layers_data_serializer={deserialize:e=>{const t=new TextDecoder("ascii"),n={};for(const i in e)n[i]=JSON.parse(t.decode(e[i]));return n}},t.layers_options_serializer={deserialize:e=>{const t={};for(const n in e){const i=JSON.parse(e[n]);t[n]=Object.assign(Object.assign({},i),{domain:u.Rect.fromTuple(i.domain)})}return t}};class m extends l.JModel{constructor(){super(...arguments),this.view_name="JView2D",this.model_name="JView2DModel"}get defaultState(){return h}get layers_data(){return this.get("_layers_data")}get linkedTransformGroup(){return this.get("linkedTransformGroup")}get layers_options(){return this.get("_layers_options")}get domain(){return this.get("_domain")}}t.JView2DModel=m,m.serializers=Object.assign(Object.assign({},s.DOMWidgetModel.serializers),{_layers_data:t.layers_data_serializer,_layers_options:t.layers_options_serializer,_domain:c.rect_serializer,_transform:c.transform_serializer,_target_transform:c.transform_serializer}),m.use=(0,l.createUseModelState)()},1210:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGetFromContext=t.createUseModelState=t.useModelEvent=t.useModel=t.JModelContext=t.JModel=t.JBaseWidget=t.initializeJApp=void 0;const i=n(4985),s=n(6271),o=n(8657);let r;t.initializeJApp=function(e){r=e};class a extends i.DOMWidgetView{static jApp(){return r}send_event(e,t){this.send({event:e,data:t})}}t.JBaseWidget=a;class l extends i.DOMWidgetModel{constructor(){super(...arguments),this.view_name="JBaseWidget",this.model_name="JBaseWidget_Model",this.syncTimeout=void 0}defaults(){return Object.assign(Object.assign(Object.assign({},super.defaults()),{_model_name:this.model_name,_model_module:o.MODULE_NAME,_model_module_version:o.MODULE_VERSION,_view_name:this.view_name,_view_module:o.MODULE_NAME,_view_module_version:o.MODULE_VERSION}),this.defaultState)}get defaultState(){return{}}get instanceID(){return this.get("_instance_id")}saveWithTimeout(){void 0!==this.syncTimeout&&clearTimeout(this.syncTimeout),this.syncTimeout=setTimeout((()=>{this.save_changes(),this.syncTimeout=void 0}),300)}}function c(){return(0,s.useContext)(t.JModelContext)}function u(e,t,n){const i=c(),o=void 0===n?[i]:[...n,i];(0,s.useEffect)((()=>{const n=e=>i&&t(i,e);return null==i||i.on(e,n),()=>{null==i||i.unbind(e,n)}}),o)}t.JModel=l,t.JModelContext=(0,s.createContext)(void 0),t.useModel=c,t.useModelEvent=u,t.createUseModelState=function(){return e=>{const t=c(),[n,i]=(0,s.useState)(null==t?void 0:t.get(e));return u(`change:${String(e)}`,(t=>{i(t.get(e))}),[e]),[n,function(n,i){null==t||t.set(e,n,i),null==t||t.save_changes()}]}},t.createGetFromContext=function(){return e=>{const t=c();return null==t?void 0:t.get(e)}}},6233:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rect_serializer=t.point_serializer=t.transform_serializer=t.byte_serializer=void 0;const i=n(4368);t.byte_serializer={deserialize:e=>new TextDecoder("ascii").decode(e)},t.transform_serializer={deserialize:e=>({center:new i.Point(e[0],e[1]),zoom:e[2]}),serialize:e=>[e.center.x,e.center.y,e.zoom]},t.point_serializer={deserialize:e=>new i.Point(e[0],e[1]),serialize:e=>[e.x,e.y]},t.rect_serializer={deserialize:e=>{switch(e.length){case 2:return new i.Rect(new i.Point(e[1],e[0]));case 4:return i.Rect.fromTuple(e)}return i.Rect.EMPTY},serialize:e=>[e.top,e.left,e.height,e.width]}},5399:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(5893),o=n(6271),r=i(n(6296));n(8877);const a=n(3136),l=n(6201),c=n(4368);function u(e,t){return`translate(${t?e:0}, ${t?0:e})`}function d(e){var t;const n=e.length*(null!==(t=e.tickLength)&&void 0!==t?t:1/3);return e.horizontal?(0,s.jsx)("line",{className:"tick",x1:0,x2:0,y1:e.length-n,y2:e.length}):(0,s.jsx)("line",{className:"tick",y1:0,y2:0,x1:e.length-n,x2:e.length})}function h(e){var t,n,i,o;const r=e.horizontal,a=e.length*(2/3),l=e.length/3+1,c=null!==(t=e.labelAnchor)&&void 0!==t?t:"middle",h=null!==(n=e.className)&&void 0!==n?n:"",m=null!==(i=e.pos)&&void 0!==i?i:0,p=null!==(o=e.labelBackground)&&void 0!==o?o:null,v={length:e.length,horizontal:e.horizontal,tickLength:e.tickLength};let f={},g=0;"before"===c?(f={textAnchor:e.horizontal?"end":"start"},g=-3):"after"===c&&(f={textAnchor:e.horizontal?"start":"end"},g=3);const b=(0,s.jsx)("text",Object.assign({fontSize:a,filter:p?"light"==p?"url(#lightBackgroundFilter)":"url(#darkBackgroundFilter)":void 0,transform:r?`translate(${g}, ${l})`:`translate(${l}, ${g}) rotate(-90)`,style:f},{children:e.label}));return(0,s.jsxs)("g",Object.assign({className:"labelTick "+h,transform:u(m,r)},{children:[b,(0,s.jsx)(d,Object.assign({},v))]}))}t.default=function(e){var t,n,i;const m="horizontal"===e.orientation,p=null!==(t=e.thickness)&&void 0!==t?t:20,v=null!==(n=e.style)&&void 0!==n?n:{},f=(0,o.useRef)(null),g=(0,r.default)(f),b=m?g.x:g.y;let y=null;const[w,x]=(0,o.useState)(!1);let _,M,z,j,S,R,O,k,I,L=p/2+" px";const D=(0,l.validNumber)(e.axisInterval.start,0),C=(0,l.validNumber)(e.axisInterval.end,1);let T=(0,l.validNumber)(e.scale,1),E=(0,l.validNumber)(e.center,(D+C)/2);if(w){const e=b/T/2;y={start:Math.round(E-e),end:Math.round(E+e)},T=b/(C-D),E=(D+C)/2}const P=b/T,N=E-P/2,A=E+P/2,B=null==y?void 0:y.start,V=null==y?void 0:y.end,K=null!==(i=e.cursorPos)&&void 0!==i?i:null;if(null!==K){const e=(K-N+.5)*T;I=(0,s.jsxs)("g",Object.assign({transform:u(e,m),className:"cursorTick"},{children:[(0,s.jsx)("rect",{x:m?-18:0,y:m?0:-18,width:m?36:p,height:m?p:36,rx:p/5,ry:p/5}),(0,s.jsx)(h,{length:p,horizontal:m,label:K.toString()})]}))}const q=Math.max(0,(D-N)*T-1),J=Math.max(0,(A-C)*T-1);[_,M,O,k,R,S,L]=(0,o.useMemo)((()=>{const e=(e,t=3)=>("number"==typeof e&&(e=e.toString()),e.toString().length*p/2.5+t),t=(0,s.jsx)("rect",{className:"out-of-domain",x:0,y:0,height:m?p:q,width:m?q:p}),n=(0,s.jsx)("rect",{className:"out-of-domain",x:m?b-J:0,y:m?0:b-J,height:m?p:J,width:m?J:p}),i=new Array,o=(D-N)*T,r=(0,s.jsx)(h,{className:"BoundariesLabelTick",length:p,tickLength:1,horizontal:m,label:D.toString(),labelAnchor:"after",pos:o}),a={start:o,end:o+e(D)};a.end>=0&&i.push(a);const c=(C-N)*T,v=(0,s.jsx)(h,{className:"BoundariesLabelTick",length:p,tickLength:1,horizontal:m,label:C.toString(),labelAnchor:"before",pos:c}),f={start:c-e(C),end:c};f.start<=b&&i.push(f);const g=(0,l.optiLog10Step)(T,80),y=(0,l.optiLog10Step)(T,12),w=Math.max(D,N),x=Math.min(C,A);R=(0,l.linspace)(w,x,g,!0).map(((e,t,{length:n})=>{const o=(e-N+.5)*T;if(!(i.findIndex((e=>(0,l.inInterval)(o,e,10)))>=0))return(0,s.jsx)(h,{className:"BoundariesLabelTick",length:p,horizontal:m,label:Math.round(e).toString(),pos:o},e)})),S=(0,l.linspace)(w,x,y,!0,g).map(((e,t,{length:n})=>{const o=(e-N+.5)*T;if(!(i.findIndex((e=>(0,l.inInterval)(o,e,2)))>=0))return(0,s.jsx)("g",Object.assign({transform:u(o,m)},{children:(0,s.jsx)(d,{length:p,horizontal:m})}),e)}));const _=Math.min((w-D)*T,p/2),M=Math.min((C-x)*T,p/2);return[t,n,r,v,R,S,m?`${_}px ${M}px ${M}px ${_}px`:`${_}px ${_}px ${M}px ${M}px`]}),[b,D,C,E,T]),[z,j]=(0,o.useMemo)((()=>{var e,t;const n=y?(y.end-y.start)*T:0,i=B?Math.max(0,(B-N)*T-1):0,o=n>5*p,r=n?(0,s.jsxs)("g",Object.assign({transform:u(q,m)},{children:[(0,s.jsx)("rect",{className:"shadow",x:0,y:0,height:m?p:i,width:m?i:p}),(0,s.jsx)(h,{className:"BoundariesLabelTick HighlightLabelTick",length:p,tickLength:1,horizontal:m,label:null!==(e=null==B?void 0:B.toString())&&void 0!==e?e:"",labelAnchor:o?"after":"before",pos:i,labelBackground:o?"light":"dark"})]})):(0,s.jsx)("g",{}),a=V?Math.max(0,(A-V)*T-1):0;return[r,n?(0,s.jsxs)("g",Object.assign({transform:u(b-J-a,m)},{children:[(0,s.jsx)("rect",{className:"shadow",x:0,y:0,height:m?p:a,width:m?a:p}),(0,s.jsx)(h,{className:"BoundariesLabelTick HighlightLabelTick",length:p,tickLength:1,horizontal:m,label:null!==(t=null==V?void 0:V.toString())&&void 0!==t?t:"",labelAnchor:o?"before":"after",labelBackground:o?"light":"dark"})]})):(0,s.jsx)("g",{})]}),[b,D,C,E,T,B,V]);const G=(0,o.useRef)(!1);return(0,a.useEventListener)(f,"wheel",(t=>{void 0!==e.onPanCenter&&(t.preventDefault(),e.onPanCenter(t.deltaY/T))})),(0,a.useEventListener)(f,"mouseenter",(t=>{const n=D-N<0||C-A>0;void 0!==e.onSetCenter&&n&&(t.preventDefault(),G.current||x(!0))})),(0,a.useEventListener)(f,"mouseleave",(t=>{void 0!==e.onSetCenter&&(t.preventDefault(),G.current||x(!1))})),(0,a.useEventListener)(f,"mousedown",(t=>{var n;if(null===f.current||void 0===e.onSetCenter||!w)return;let i=((m?t.clientX:t.clientY)-f.current.getBoundingClientRect()[m?"left":"top"]+N)/T;const s=null!==(n=e.center)&&void 0!==n?n:E;y&&(0,l.inInterval)(i,y)||(i=void 0);const o=t=>{if(null===f.current||void 0===e.onSetCenter)return;const n=((m?t.clientX:t.clientY)-f.current.getBoundingClientRect()[m?"left":"top"]+N)/T;void 0===i?e.onSetCenter(n):e.onSetCenter(s+n-i)};G.current=!0,void 0===i&&o(t),(0,a.captureMouseEvents)(t,o,(e=>{if(G.current=!1,null===f.current)return;const t=new c.Point(e.clientX,e.clientY),n=c.Rect.fromDOMRect(f.current.getBoundingClientRect());t.in(n)||x(!1)}))})),(0,s.jsx)("div",Object.assign({ref:f,className:"RulerAxis",style:Object.assign({height:m?p:"100%",width:m?"100%":p,"--thickness":p},v)},{children:(0,s.jsxs)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",style:{borderRadius:L}},{children:[(0,s.jsxs)("defs",{children:[(0,s.jsxs)("filter",Object.assign({x:"0",y:"0",width:"1",height:"1",id:"lightBackgroundFilter"},{children:[(0,s.jsx)("feFlood",{result:"bg"}),(0,s.jsxs)("feMerge",{children:[(0,s.jsx)("feMergeNode",{in:"bg"}),(0,s.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})),(0,s.jsxs)("filter",Object.assign({x:"0",y:"0",width:"1",height:"1",id:"darkBackgroundFilter"},{children:[(0,s.jsx)("feFlood",{result:"bg"}),(0,s.jsxs)("feMerge",{children:[(0,s.jsx)("feMergeNode",{in:"bg"}),(0,s.jsx)("feMergeNode",{in:"SourceGraphic"})]})]}))]}),_,M,S,R,O,k,z,j,I]}))}))}},2857:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5893),s=n(6271),o=n(9394);function r(e){const{data:t,options:n,sceneDomain:s}=e,{opacity:o}=n;return(0,i.jsx)("img",{src:t.data,alt:n.label,style:Object.assign({opacity:o,imageRendering:e.smooth?"auto":"pixelated"},l(n.domain,s))})}function a(e){const{data:t,options:n,sceneDomain:r}=e,{opacity:a}=n,c=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const e=c.current;if(null==e)return;const i=e.getContext("2d");if(null==i)return;const s=new Image;s.onload=()=>{e.width=s.width,e.height=s.height,i.clearRect(0,0,e.width,e.height),i.drawImage(s,0,0);const r=i.getImageData(0,0,e.width,e.height),a=n.cmap[0]||["#0000"],l=Object.fromEntries(t.infos.labels.map((e=>{let t;return t=e in n.cmap?(0,o.hexToRGBA)(n.cmap[e]):(0,o.hexToRGBA)(a[(e-1)%a.length]),[e,t]})));for(let e=0;e<r.data.length;e+=4){const t=r.data[e]|r.data[e+1]<<8|r.data[e+2]<<16|255-r.data[e+3]<<24;if(0==t){r.data[e+3]=0;continue}const n=l[t];r.data[e]=n[0],r.data[e+1]=n[1],r.data[e+2]=n[2],r.data[e+3]=n[3]}i.putImageData(r,0,0)},s.src=t.data}),[t.data,n.cmap]),(0,i.jsx)("canvas",{ref:c,style:Object.assign({opacity:a,imageRendering:e.smooth?"crisp-edges":"pixelated"},l(n.domain,r))})}function l(e,t){return{top:(e.top-t.top)/t.height*100+"%",left:(e.left-t.left)/t.width*100+"%",width:e.width/t.width*100+"%",height:e.height/t.height*100+"%",position:"absolute"}}t.default=function(e){const t=[];for(const[n,i]of Object.entries(e.options))n in e.layers&&i.visible&&t.push({name:n,zId:i.zIndex});t.sort(((e,t)=>e.zId-t.zId));const n=[];for(const s of t.map((e=>e.name))){const t=e.layers[s],o=e.options[s],l=e.scale*o.domain.width/e.sceneDomain.width;switch(t.type){case"image":n.push((0,i.jsx)(r,{data:t,options:o,sceneDomain:e.sceneDomain,smooth:l<10},s));break;case"label":n.push((0,i.jsx)(a,{data:t,options:o,sceneDomain:e.sceneDomain,smooth:l<10},s))}}return(0,i.jsx)(i.Fragment,{children:n})}},7187:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(5893),o=n(6271),r=n(1210),a=n(338),l=n(2222),c=n(4368),u=n(6448),d=i(n(5399)),h=i(n(2857)),m=n(452);n(1283);const p=n(4683),v=n(6037),f=n(8597),g=n(1196),b=(0,g.instantiatedStore)((()=>(0,v.create)()((0,g.synchronizableStates)((0,f.subscribeWithSelector)((()=>({transform:{center:new c.Point(.5,.5),coord:"relative",zoom:0}})))))));var y;t.default=(y=function(e){var t;const n=(0,o.useRef)(null),[i]=a.JView2DModel.use("_loading"),u=e.model,m=b(u.instanceID),v=u.domain,f=u.layers_data,g=u.layers_options;let y=c.Rect.EMPTY;Object.values(g).forEach((e=>{y=y.union(e.domain)})),(0,o.useMemo)((()=>{m.setSync(e.model.linkedTransformGroup)}),[e.model.linkedTransformGroup]);const w=(0,o.useMemo)((()=>{let t;return[new p.Observable((n=>{m.subscribe((e=>e.transform),(i=>{e.model.set("_transform",i),e.model.saveWithTimeout(),i&&t!==i&&(n.next(i),t=i)}))})),e=>{t=e,m.setState({transform:e})}]}),[]),x={onClick:null===(t=e.events)||void 0===t?void 0:t.onClick},_=(0,l.useZoomTransform)(n,y,25,v,w),M=(0,l.useSceneMouseEventListener)(_,x);(0,r.useModelEvent)("change:_target_transform",(e=>{console.log("change:_target_transform"),_.dispatch({transform:e.get("_target_transform"),animation:{duration:500}})}));const z={thickness:15,scale:_.scale},j={display:"grid",gridTemplateColumns:`${z.thickness}px auto`,gridTemplateRows:`${z.thickness}px auto`},S=_.center.x-_.sceneRect.left+_.sceneDomain.left,R=_.center.y-_.sceneRect.top+_.sceneDomain.top,O={width:_.sceneRect.width*_.scale+"px",height:_.sceneRect.height*_.scale+"px",position:"absolute",left:`calc(50% ${S<0?"+":"-"} ${Math.abs(S)*_.scale}px)`,top:`calc(50% ${R<0?"+":"-"} ${Math.abs(R)*_.scale}px)`};return(0,s.jsxs)("div",Object.assign({className:"ImageViewerWidget",style:j},{children:[(0,s.jsx)(d.default,Object.assign({orientation:"horizontal",center:_.center.x,cursorPos:null==M?void 0:M.x,onPanCenter:e=>{_.dispatch({pan:new c.Point(e,0)})},onSetCenter:e=>{_.dispatch({center:new c.Point(e,_.center.y)})},axisInterval:{start:_.sceneDomain.left,end:_.sceneDomain.right},style:{gridRow:1,gridColumn:2}},z)),(0,s.jsx)(d.default,Object.assign({orientation:"vertical",center:_.center.y,cursorPos:null==M?void 0:M.y,onPanCenter:e=>{_.dispatch({pan:new c.Point(0,e)})},onSetCenter:e=>{_.dispatch({center:new c.Point(_.center.x,e)})},axisInterval:{start:_.sceneDomain.top,end:_.sceneDomain.bottom},style:{gridRow:2,gridColumn:1}},z)),(0,s.jsx)("div",Object.assign({ref:n,style:{gridRow:2,gridColumn:2,cursor:"crosshair"}},{children:(0,s.jsx)("div",Object.assign({className:"ImageViewport"},{children:(0,s.jsx)("div",Object.assign({style:O},{children:(0,s.jsx)(h.default,{layers:f,options:g,sceneDomain:y,scale:_.scale})}))}))}))]}))},e=>(0,s.jsx)(r.JModelContext.Provider,Object.assign({value:e.model},{children:(0,s.jsx)(u.ThemeProvider,Object.assign({theme:(0,m.useTheme)()},{children:(0,s.jsx)(y,Object.assign({},e))}))})))},4051:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Easing=t.Animation=t.Animator=void 0;const i=n(4368);t.Animator=class{constructor(e,t){this.callback=e,this.t=0,this._duration=750,this._freq=30,this._skipMissedFrames=!0,this._startedTime=0,this.timer=null,this.delayTimer=null,t&&(this.animations=null==t?void 0:t.animations,this.onStart=t.onStart,this.onPause=t.onPause,this.onStop=t.onStop,void 0!==t.duration&&(this._duration=t.duration),void 0!==t.freq&&(this._freq=t.freq),void 0!==t.skipMissedFrames&&(this._skipMissedFrames=t.skipMissedFrames)),this.dt=this._duration/this._freq}get duration(){return this._duration}set duration(e){this.dt=e/this._freq,this._duration=e,null!==this.timer&&(this.pause(),this.start())}get freq(){return this._freq}set freq(e){if(e<=0)throw RangeError("Animator update frequency must be strictly greater than 0.");this.dt=this._duration/e,this._freq=e,null!==this.timer&&(this.pause(),this.start())}run(e,t,n,i=!1){this.stop(),this.animations=e,t&&(this.duration=t),this.start(n,i)}get running(){return null!==this.timer||null!==this.delayTimer}start(e,t=!1){this.running||(e?this.delayTimer=setTimeout((()=>{this.delayTimer=null,this.start()}),e):(this.onStart&&this.onStart(this),this._startedTime=Date.now(),this.timer=setInterval((()=>{this._skipMissedFrames?this.t=Date.now()-this._startedTime:this.t+=this.dt,this.t<this._duration&&this._callback(),this.t>=this._duration&&(this.t=this._duration,this._callback(),this.pause())}),this.dt),t&&this._callback()))}restart(e=!0){this.stop(),this.start(0,e)}pause(){null!==this.timer?(clearInterval(this.timer),this.timer=null,this.onPause&&this.onPause(this)):null!==this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)}stop(){null!==this.timer?(clearInterval(this.timer),this.timer=null):null!==this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null),this.onStop&&this.onStop(this),this.t=0}_callback(){const e={};for(const t in this.animations)Object.assign(e,{[t]:this.animations[t].compute(this.t/this.duration)});this.callback(e)}};class s{constructor(e){this.keyframes=e}compute(e){let t=Math.round(e*(this.keyframes.length-2));do{if(this.keyframes[t].t>e)t--;else{if(!(this.keyframes[t+1].t<e)){const n=this.keyframes[t],i=this.keyframes[t+1];return o(e=(e-n.t)/(i.t-n.t),n.v,i.v,n.easing)}t++}}while(t>=0&&t<this.keyframes.length-1);return-1===t?this.keyframes[0].v:this.keyframes[this.keyframes.length-1].v}get firstKey(){return this.keyframes[0]}get lastKey(){return this.keyframes[this.keyframes.length-1]}static simple(e,t,n="linear",i=0,o=1){return new s([{t:i,v:e,easing:n},{t:o,v:t}])}}function o(e,n,s,o){return void 0!==o&&("string"!=typeof o&&"number"!=typeof o||(o=t.Easing[o]),e=o(e)),"number"==typeof n?e*s+n*(1-e):(i.Point,n.interpolate(s,e))}t.Animation=s,t.Easing={linear:e=>e,sinusoidalIn:e=>1-Math.cos(e*Math.PI/2),sinusoidalOut:e=>Math.sin(e*Math.PI/2),sinusoidalInOut:e=>-.5*(Math.cos(Math.PI*e)-1),quadraticIn:e=>e*e,quadraticOut:e=>e*(2-e),quadraticInOut:e=>e<.5?2*e*e:(4-2*e)*e-1,cubicIn:e=>Math.pow(e,3),cubicOut:e=>{const t=e-1;return Math.pow(t,3)+1},cubicInOut:e=>e<.5?4*Math.pow(e,3):(e-1)*(2*e-2)*(2*e-2)+1,quarticIn:e=>Math.pow(e,4),quarticOut:e=>{const t=e-1;return 1-Math.pow(t,4)},quarticInOut:e=>{let t=e;return t<.5?8*Math.pow(t,4):(t-=1,1-8*Math.pow(t,4))},quinticIn:e=>Math.pow(e,5),quinticOut:e=>{const t=e-1;return 1+Math.pow(t,5)},quinticInOut:e=>{let t=e;return t<.5?16*Math.pow(t,5):(t-=1,1+16*Math.pow(t,5))},circularIn:e=>-(Math.sqrt(1-e*e)-1),circularOut:e=>{const t=e-1;return Math.sqrt(1-t*t)},circularInOut:e=>{let t=2*e;return t<1?-.5*(Math.sqrt(1-t*t)-1):(t-=2,.5*(Math.sqrt(1-t*t)+1))},exponentialIn:e=>Math.pow(2,10*(e-1))-.001,exponentialOut:e=>1-Math.pow(2,-10*e),exponentialInOut:e=>{const t=2*e;return t<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))},backIn:e=>{const t=1.70158;return e*e*((t+1)*e-t)},backOut:e=>{const t=1.70158,n=e-1;return n*n*((t+1)*n+t)+1},backInOut:e=>{const t=2.5949095;let n=2*e;return n<1?n*n*((t+1)*n-t)*.5:(n-=2,.5*(n*n*((t+1)*n+t)+2))},elasticIn:e=>0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI),elasticOut:e=>0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1,elasticInOut:e=>{if(0===e)return 0;if(1===e)return 1;const t=2*e;return t<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1},bounceIn:e=>1-t.Easing.easingBounceOut(1-e),bounceOut:e=>{let t=e;return t<1/2.75?7.5625*t*t:t<2/2.75?(t-=1.5/2.75,7.5625*t*t+.75):t<2.5/2.75?(t-=2.25/2.75,7.5625*t*t+.9375):(t-=2.625/2.75,7.5625*t*t+.984375)},bounceInOut:e=>e<.5?.5*t.Easing.easingBounceIn(2*e):.5*t.Easing.easingBounceOut(2*e-1)+.5}},9394:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hexToRGBA=void 0,t.hexToRGBA=function(e){if(/^#([A-Fa-f0-9]{3,4}){1,2}$/.test(e)){let t=e.substring(1).split("");3==t.length?t=[t[0],t[0],t[1],t[1],t[2],t[2],"FF"]:4==t.length?t=[t[0],t[0],t[1],t[1],t[2],t[2],t[3],t[3]]:6==t.length&&(t=[...t,"FF"]);const n=t.join("");return[parseInt(n.substring(0,2),16),parseInt(n.substring(2,4),16),parseInt(n.substring(4,6),16),parseInt(n.substring(6,8),16)]}throw new Error("Bad Hex Color format: "+e)}},3136:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.captureMouseEvents=t.useEventListener=void 0;const i=n(6271);t.useEventListener=function(e,t,n,s){(0,i.useEffect)((()=>{const i=e.current;if(!i)return;const o=e=>n(e);return i.addEventListener(t,o,s),()=>i.removeEventListener(t,o)}),[e,t,n,s])};const s={capture:!0};t.captureMouseEvents=function(e,t,n){const i=e=>{n(e),e.preventDefault(),e.stopPropagation(),document.body.style.pointerEvents="auto",document.removeEventListener("mouseup",i,s),document.removeEventListener("mousemove",o,s)},o=e=>{t(e),e.preventDefault(),e.stopPropagation()};document.body.style.pointerEvents="none",document.addEventListener("mouseup",i,s),document.addEventListener("mousemove",o,s),e.preventDefault(),e.stopPropagation()}},6201:(e,t)=>{"use strict";function n(e){return null!=e&&"number"==typeof e&&!isNaN(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.inInterval=t.optiLog10Step=t.linspace=t.validNumber=t.isValidNumber=void 0,t.isValidNumber=n,t.validNumber=function(e,t){return n(e)?e:t},t.linspace=function(e,t,n,i=!1,s){const o=new Array;let r=i?Math.ceil(e/n)*n:e;for(;r<=t;)(void 0===s||r%s)&&o.push(r),r+=n;return o},t.optiLog10Step=function(e,t=30){const n=Math.log10(t/e),i=Math.trunc(n),s=n-i;return i>=0&&s>.69897?Math.pow(10,i+1):i>0&&s<=.39794?2.5*Math.pow(10,i):n>=0?5*Math.pow(10,i):1},t.inInterval=function(e,t,n=0){return t.start-n<=e&&e<=t.end+n}},452:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useTheme=void 0;const i=n(6448),s=n(6271),o=e=>getComputedStyle(document.documentElement).getPropertyValue(e).trim();t.useTheme=()=>{const[e]=(0,s.useState)((()=>(0,i.createTheme)({palette:{primary:{main:o("--jp-brand-color1"),light:o("--jp-brand-color0"),dark:o("--jp-brand-color2")},secondary:{main:"#fd7705"},text:{primary:o("--jp-ui-font-color0"),secondary:o("--jp-brand-color0"),disabled:o("--jp-ui-font-color3")},action:{active:o("--jp-inverse-layout-color3"),hover:o("--jp-layout-color3"),disabled:o("--jp-ui-font-color3")},background:{default:o("--jp-layout-color0"),paper:o("--jp-layout-color2")},divider:o("--jp-layout-color1")},typography:{htmlFontSize:16,fontSize:12}})));return e}},4368:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Rect=t.ORIGIN=t.Point=void 0;class n{constructor(e=0,t=0){this.x=e,this.y=t}add(e){return e instanceof n?new n(this.x+e.x,this.y+e.y):new n(this.x+e,this.y+e)}substract(e){return e instanceof n?new n(this.x-e.x,this.y-e.y):new n(this.x-e,this.y-e)}divide(e){return e instanceof n?new n(this.x/e.x,this.y/e.y):new n(this.x/e,this.y/e)}multiply(e){return e instanceof n?new n(this.x*e.x,this.y*e.y):new n(this.x*e,this.y*e)}interpolate(e,t){return new n(this.x*(1-t)+e.x*t,this.y*(1-t)+e.y*t)}clip(e){return e instanceof n?new n(Math.min(e.x,this.x),Math.min(e.y,this.y)):new n(Math.min(e.bottomRight.x,Math.max(e.topLeft.x,this.x)),Math.min(e.bottomRight.y,Math.max(e.topLeft.y,this.y)))}in(e,t=!1){return e instanceof n?t?this.x<e.x&&this.y<e.y:this.x<=e.x&&this.y<=e.y:t?e.topLeft.x<this.x&&this.x<e.bottomRight.x&&e.topLeft.y<this.y&&this.y<e.bottomRight.y:e.topLeft.x<=this.x&&this.x<=e.bottomRight.x&&e.topLeft.y<=this.y&&this.y<=e.bottomRight.y}round(){return new n(Math.round(this.x),Math.round(this.y))}floor(){return new n(Math.floor(this.x),Math.floor(this.y))}ceil(){return new n(Math.ceil(this.x),Math.ceil(this.y))}neg(){return new n(-this.x,-this.y)}inv(){return new n(1/this.x,1/this.y)}abs(){return new n(Math.abs(this.x),Math.abs(this.y))}min(){return Math.min(this.x,this.y)}max(){return Math.max(this.x,this.y)}norm(){return Math.sqrt(this.x*this.x+this.y*this.y)}hasZero(){return 0===this.x||0===this.y}isZero(){return 0===this.x&&0===this.y}equals(e){return this.x===e.x&&this.y===e.y}}t.Point=n,n.ORIGIN=Object.freeze(new n(0,0)),t.ORIGIN=n.ORIGIN;class i{constructor(e,n){void 0!==n?(this.topLeft=e,this.bottomRight=n):(this.topLeft=t.ORIGIN,this.bottomRight=e)}static unitary(){return new i(new n(1,1))}static fromXY(e,t,s,o){return new i(new n(Math.min(e,t),Math.min(s,o)),new n(Math.max(e,t),Math.max(s,o)))}static fromTuple(e){let[t,s,o,r]=e;return s<0&&(r+=s,s=-s),t<0&&(o+=t,t=-t),new i(new n(r,o),new n(r+s,o+t))}static fromCenter(e,t){const n=t.divide(2).abs();return new i(e.substract(n),e.add(n))}static fromDOMRect(e){return new i(new n(e.left,e.top),new n(e.right,e.bottom))}get top(){return this.topLeft.y}get left(){return this.topLeft.x}get right(){return this.bottomRight.x}get bottom(){return this.bottomRight.y}get width(){return this.bottomRight.x-this.topLeft.x}get height(){return this.bottomRight.y-this.topLeft.y}get size(){return this.bottomRight.substract(this.topLeft)}get center(){return this.bottomRight.add(this.topLeft).divide(2)}checkPositiveSize(){return this.width>=0&&this.height>=0}isEmpty(){return this.width<=0||this.height<=0}translate(e){return new i(this.topLeft.add(e),this.bottomRight.add(e))}scale(e){return new i(this.topLeft.multiply(e),this.bottomRight.multiply(e))}in(e,t=!1){return this.topLeft.in(e,t)&&this.bottomRight.in(e,t)}intersection(e){return new i(this.topLeft.clip(e),this.bottomRight.clip(e))}union(e){return i.fromXY(Math.min(this.left,e.left),Math.max(this.right,e.right),Math.min(this.top,e.top),Math.max(this.bottom,e.bottom))}pad(e,n=!1){let s;return e instanceof i?(n&&(e=new i(t.ORIGIN.substract(e.topLeft),t.ORIGIN.substract(e.bottomRight))),s=new i(this.topLeft.add(e.topLeft),this.bottomRight.add(e.bottomRight))):(n&&(e=t.ORIGIN.substract(e)),s=new i(this.topLeft.add(e),this.bottomRight.substract(e))),s.checkPositiveSize()?s:i.fromCenter(s.center,t.ORIGIN)}interpolate(e,t){return new i(this.topLeft.interpolate(e.topLeft,t),this.bottomRight.interpolate(e.bottomRight,t))}}t.Rect=i,i.EMPTY=Object.freeze(new i(t.ORIGIN,t.ORIGIN))},6296:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(5808)),o=i(n(6271)),r=n(4368);t.default=function(e){const[t,n]=o.default.useState(new r.Point(0,0));return o.default.useLayoutEffect((()=>{var t,i;const s=null===(t=e.current)||void 0===t?void 0:t.getBoundingClientRect().width,o=null===(i=e.current)||void 0===i?void 0:i.getBoundingClientRect().height;n(new r.Point(s,o))}),[e]),(0,s.default)(e,(e=>{const{width:t,height:i}=e.contentRect;n(new r.Point(t,i))})),t}},2222:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useSceneMouseEventListener=t.useZoomTransform=t.ZoomTransform=void 0;const s=n(6271),o=n(4368),r=i(n(5808)),a=n(4051);class l{constructor(e,t,n,i){this._ref=e,this._sceneRect=t,this._maxScale=n,this._sceneDefaultRect=i}get node(){return this._ref.current}getViewBoundingRect(){return this._ref.current?o.Rect.fromDOMRect(this._ref.current.getBoundingClientRect()):o.Rect.fromCenter(o.ORIGIN,o.ORIGIN)}get viewSize(){return this._viewSize||(this._viewSize=this.getViewBoundingRect().size),this._viewSize}set viewSize(e){this._viewSize=e,this.invalidatedScaleConstants()}get sceneRect(){return this._sceneRect}set sceneRect(e){this._sceneRect=e,this.invalidatedScaleConstants()}get sceneMainDomain(){return this._sceneDefaultRect&&!this._sceneDefaultRect.isEmpty()?this._sceneDefaultRect:this.sceneRect}set sceneMainDomain(e){this._sceneDefaultRect=e,this.invalidatedScaleConstants()}invalidatedScaleConstants(){this._minScale=void 0,this._minZoom=void 0,this._defaultScale=void 0,this._maxZoom=void 0,this._relativeSceneBoundaries=void 0}get minScale(){if(void 0===this._minScale){if(this.sceneRect.isEmpty())return 1;this._minScale=Math.min(this.viewSize.divide(this.sceneRect.size).min()+1e-8,this.maxScale)}return this._minScale}get minZoom(){if(void 0===this._minZoom){if(this.sceneRect.isEmpty())return 0;this._minZoom=this.scale2zoom(this.minScale)}return this._minZoom}get maxScale(){return this._maxScale}get defaultScale(){if(void 0===this._defaultScale){if(this.sceneMainDomain.isEmpty()||this.viewSize.hasZero())return 1;this._defaultScale=this.viewSize.divide(this.sceneMainDomain.size).min()+1e-8}return this._defaultScale}get relativeSceneBoundaries(){return void 0===this._relativeSceneBoundaries&&(this._relativeSceneBoundaries=this.sceneRect.translate(this.sceneMainDomain.topLeft.neg()).scale(this.sceneMainDomain.size.inv())),this._relativeSceneBoundaries}get maxZoom(){return void 0===this._maxZoom&&(this._maxZoom=this.scale2zoom(this.maxScale)),this._maxZoom}scale2zoom(e){return Math.log2(e/this.defaultScale)}zoom2scale(e){return Math.pow(2,e)*this.defaultScale}scene2relative(e){return e instanceof o.Point?this.sceneMainDomain.isEmpty()?new o.Point(.5,.5):e.substract(this.sceneMainDomain.topLeft).divide(this.sceneMainDomain.size):e instanceof o.Rect?this.sceneMainDomain.isEmpty()?o.Rect.unitary():e.translate(this.sceneMainDomain.topLeft.neg()).scale(this.sceneMainDomain.size.inv()):void 0}relative2scene(e){return e instanceof o.Point?e.multiply(this.sceneMainDomain.size).add(this.sceneMainDomain.topLeft):e instanceof o.Rect?e.scale(this.sceneMainDomain.size).translate(this.sceneMainDomain.topLeft):void 0}centerInSceneCoord(e){return"relative"===e.coord?this.relative2scene(e.center):e.center}centerInRelativeCoord(e){return"relative"===e.coord?e.center:this.scene2relative(e.center)}relativeTransform(e){return"relative"===e.coord?e:{zoom:e.zoom,center:this.scene2relative(e.center),coord:"relative"}}toRelativeCoord(e,t,n){if(!(e instanceof o.Point))return new o.Rect(this.toRelativeCoord(e.topLeft,t,n),this.toRelativeCoord(e.bottomRight,t,n));switch(n){case"view":return this.sceneMainDomain.isEmpty()?new o.Point(.5,.5):e.substract(this.viewSize.divide(2)).divide(this.zoom2scale(t.zoom)).divide(this.sceneMainDomain.size).add(this.centerInRelativeCoord(t));case"relative":return e;default:return this.scene2relative(e)}}toSceneCoord(e,t,n){if(!(e instanceof o.Point))return new o.Rect(this.toSceneCoord(e.topLeft,t,n),this.toSceneCoord(e.bottomRight,t,n));switch(n){case"view":return e.substract(this.viewSize.divide(2)).divide(this.zoom2scale(t.zoom)).add(this.centerInSceneCoord(t));case"relative":return this.relative2scene(e);default:return e}}toViewCoord(e,t,n){return e instanceof o.Point?"view"===n?e:("relative"===n&&(e=this.toSceneCoord(e,t,"relative")),e.substract(this.centerInSceneCoord(t)).multiply(this.zoom2scale(t.zoom)).add(this.viewSize.divide(2))):new o.Rect(this.toViewCoord(e.topLeft,t,n),this.toViewCoord(e.bottomRight,t,n))}transform2VisibleArea(e){return o.Rect.fromCenter(this.centerInSceneCoord(e),this.viewSize.divide(this.zoom2scale(e.zoom)))}visibleArea2Transform(e,t){let n=e.center,i=e.size;return"relative"===t?i=i.multiply(this.sceneMainDomain.size):n=this.scene2relative(n),{zoom:this.scale2zoom(this.viewSize.divide(i).min()),center:n,coord:"relative"}}constraintZoom(e){return Math.min(Math.max(e,this.minZoom),this.maxZoom)}constraintCenter(e){const t=e.center;if(isNaN(e.center.x)||isNaN(e.center.y)||this.sceneRect.isEmpty())return Object.assign(Object.assign({},e),{center:o.ORIGIN});const n=this.zoom2scale(e.zoom),i=this.viewSize.divide(2*n).clip(this.sceneRect.size.divide(2)),s="relative"===e.coord?this.relativeSceneBoundaries.pad(i.divide(this.sceneMainDomain.size)):this.sceneRect.pad(i);return Object.assign(Object.assign({},e),{center:t.clip(s)})}constraintTransform(e){const t=this.constraintZoom(e.zoom);return this.constraintCenter(Object.assign(Object.assign({},e),{zoom:t}))}applyZoom(e,t,n,i){const s=this.constraintZoom(e.zoom+t);if(0==(t=s-e.zoom))return e;if(n){let o,r=this.centerInSceneCoord(e);return"view"===i?o=n.substract(this.viewSize.divide(2)).multiply(1/this.zoom2scale(e.zoom)-1/this.zoom2scale(s)):("relative"===i&&(n=this.relative2scene(n)),o=n.substract(r).multiply(1-Math.pow(2,-t))),this.constraintCenter({center:r.add(o),zoom:s})}return this.constraintCenter(Object.assign(Object.assign({},e),{zoom:s}))}}class c{constructor(e,t){this.areaState=e,this.animator=new a.Animator((e=>{this.dispatch({animStep:{center:e.center,zoom:e.zoom,coord:"relative"}})}),{onStop:()=>this.animationTarget=void 0}),this.transform=t}get transform(){return this._t}set transform(e){this._t=e,this._scale=this.areaState.zoom2scale(e.zoom)}toSceneCoord(e,t){return this.areaState.toSceneCoord(e,this._t,t)}toViewCoord(e,t){return this.areaState.toViewCoord(e,this._t,t)}toRelativeCoord(e,t){return this.areaState.toRelativeCoord(e,this._t,t)}view2scene(e){return e.substract(this.areaState.viewSize.divide(2)).divide(this.scale).add(this.center)}scene2view(e){return e.substract(this.center).multiply(this.scale).add(this.areaState.viewSize.divide(2))}get scale(){return this._scale}get center(){return this.areaState.centerInSceneCoord(this._t)}get viewOffset(){return this.areaState.centerInSceneCoord(this._t).multiply(this.scale).substract(this.areaState.viewSize.divide(2))}get visibleArea(){return o.Rect.fromCenter(this.transform.center,this.areaState.viewSize.divide(this.transform.zoom))}get sceneDomain(){return this.areaState.sceneMainDomain}get sceneRect(){return this.areaState.sceneRect}}t.ZoomTransform=c,t.useZoomTransform=function(e,t,n,i,u){const d=new l(e,t,n,i),h={center:new o.Point(.5,.5),zoom:0,coord:"relative"},[[m],p]=(0,s.useReducer)(((e,t)=>{var n,i,s,o;const[r,l]=e;let c=l;const u=r.areaState;let d=c;if("syncTransform"in t)return d=u.constraintTransform(t.syncTransform),r.transform=d,r.animator.stop(),[r,d];if("animStep"in t)d=t.animStep;else{if(r.animator.running&&(r.animationTarget&&(c=r.animationTarget,d=c),r.animator.stop()),"transform"in t)d=u.constraintTransform(t.transform);else if("center"in t){const e=u.toSceneCoord(t.center,c,t.coord);d=u.constraintCenter(Object.assign(Object.assign({},c),{center:e,coord:"scene"}))}else if("zoom"in t)d=u.applyZoom(c,t.zoom,t.zoomCenter,t.zoomCenterCoord);else if("pan"in t){let e=t.pan;"relative"===t.coord?e=e.multiply(u.sceneMainDomain.size):"view"===t.coord&&(e=e.multiply(r.scale)),d=u.constraintCenter({zoom:c.zoom,center:u.centerInSceneCoord(c).add(e)})}else if("ensureVisible"in t)d=u.visibleArea2Transform(t.ensureVisible);else if("sceneRect"in t)r.areaState.sceneRect=t.sceneRect,d=r.areaState.constraintTransform(c);else if("sceneDefaultRect"in t){const e=u.relativeTransform(c);r.areaState.sceneMainDomain=t.sceneDefaultRect,d=r.areaState.constraintTransform(e)}else"viewSize"in t&&(r.areaState.viewSize=t.viewSize,d=r.areaState.constraintTransform(c));if("animation"in t){let e=null===(n=t.animation)||void 0===n?void 0:n.centerAnim;const h=u.centerInRelativeCoord(l),m=u.centerInRelativeCoord(d);e&&(e.firstKey.v=h,e.lastKey.v=m);let p=null===(i=t.animation)||void 0===i?void 0:i.scaleAnim;if(p)p.firstKey.v=l.zoom,p.lastKey.v=d.zoom;else if(d.zoom<l.zoom)p=a.Animation.simple(l.zoom,d.zoom,"quadraticOut"),e||(e=new a.Animation([{t:.2,v:h,easing:"cubicInOut"},{t:1,v:m}]));else if(d.zoom-l.zoom<-.5||u.centerInSceneCoord(c).substract(u.centerInSceneCoord(d)).norm()*r.scale<u.viewSize.max()/2)p=a.Animation.simple(l.zoom,d.zoom,"quadraticOut"),e||(e=new a.Animation([{t:0,v:h,easing:"cubicOut"},{t:.9,v:m}]));else{const t=Math.sqrt(l.zoom+1)-1;p=new a.Animation([{t:0,v:l.zoom,easing:"cubicOut"},{t:.3,v:t,easing:"cubicInOut"},{t:1,v:d.zoom}]),e||(e=new a.Animation([{t:0,v:h,easing:"cubicInOut"},{t:.9,v:m}]))}return e||(e=a.Animation.simple(h,m,"cubicInOut")),r.animator.run({center:e,zoom:p},(null===(s=t.animation)||void 0===s?void 0:s.duration)||750),!1===(null===(o=t.animation)||void 0===o?void 0:o.cancelable)&&(r.animationTarget=d),[r,c]}}var h,m;return r.syncTransform&&(m=l,!(h=d).center.equals(m.center)||h.zoom!==m.zoom)&&r.syncTransform[1](r.areaState.relativeTransform(d)),r.transform=d,[r,d]}),[new c(d,h),h]);return(0,s.useLayoutEffect)((()=>{p({sceneDefaultRect:null!=i?i:null})}),[null==i?void 0:i.left,null==i?void 0:i.top,null==i?void 0:i.width,null==i?void 0:i.height]),(0,s.useLayoutEffect)((()=>{p({sceneRect:t})}),[t.left,t.top,t.width,t.height]),(0,s.useLayoutEffect)((()=>{if(m.syncTransform=u,!u)return;const e=u[0].subscribe((e=>p({syncTransform:e})));return()=>{e.unsubscribe()}}),[u,m]),(0,r.default)(e,(e=>{const{width:t,height:n}=e.contentRect,i=new o.Point(t,n);i!==m.areaState.viewSize&&p({viewSize:i})})),m.dispatch!==p&&(m.dispatch=p),m};class u{constructor(e){this.zoomTransform=e,this.panning=!1,this.initialEvent=void 0,this.lastEvent=void 0}startPan(e){var t;null===(t=this.zoomTransform.areaState.node)||void 0===t||t.requestPointerLock(),this.panning=!0,this.lastEvent=e,this.initialEvent=e}endPan(){document.exitPointerLock(),this.panning=!1,this.lastEvent=void 0,this.initialEvent=void 0}pan(e){e.isZero()||this.zoomTransform.dispatch({pan:e})}zoom(e,t){this.zoomTransform.dispatch({zoom:e,zoomCenter:t})}}t.useSceneMouseEventListener=function(e,t,n=!0){const[i,r]=(0,s.useState)(null),a=(0,s.useMemo)((()=>{const i={};return(null==t?void 0:t.onMouseDown)||(i.onMouseDown=(e,t)=>{0!==e.button&&3!==e.button||(t.startPan(e),r(null))}),i.onMouseMove=(e,i)=>{i.panning&&i.lastEvent?i.pan(e.movement.neg()):((null==t?void 0:t.onMouseMove)&&t.onMouseMove(e,i),n&&r(e.cursor.floor())),i.lastEvent=e},i.onMouseUp=(e,n)=>{var i;n.panning&&e.button===(null===(i=n.initialEvent)||void 0===i?void 0:i.button)?(n.endPan(),r(e.cursor.floor())):(null==t?void 0:t.onMouseUp)&&t.onMouseUp(e,n)},i.onMouseLeave=(e,i)=>{i.panning&&i.endPan(),(null==t?void 0:t.onMouseLeave)&&t.onMouseLeave(e,i),n&&r(null)},i.onClick=(e,n)=>{var i;n.panning&&e.button===(null===(i=n.initialEvent)||void 0===i?void 0:i.button)?n.endPan():(null==t?void 0:t.onClick)&&t.onClick(e,n)},(null==t?void 0:t.onWheel)||(i.onWheel=t=>{const n={zoom:-t.deltaY,zoomCenter:t.viewCursor,zoomCenterCoord:"view"};Math.abs(t.deltaY)>1?e.dispatch(Object.assign(Object.assign({},n),{animation:{duration:200,cancelable:!1}})):e.dispatch(n)}),i}),[t]);return(0,s.useEffect)((()=>{const t=e.areaState.node;if(!t)return;const n=new u(e),i=i=>{if(!(null==a?void 0:a.onWheel))return;i.preventDefault();const s=o.Rect.fromDOMRect(t.getBoundingClientRect()),r=new o.Point(i.clientX,i.clientY).substract(s.topLeft),l=function(e,t,n){return{cursor:t,viewCursor:n,deltaX:e.deltaX/100,deltaY:e.deltaY/100,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,button:e.button,buttons:e.buttons}}(i,e.view2scene(r),r);null==a||a.onWheel(l,n)},s={0:null,1:null,2:null,3:null,4:null},r=i=>{i.preventDefault();const r=o.Rect.fromDOMRect(t.getBoundingClientRect()),l=new o.Point(i.clientX,i.clientY).substract(r.topLeft),c=function(e,t,n,i){return{cursor:t,viewCursor:n,movement:i,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,button:e.button,buttons:e.buttons}}(i,e.view2scene(l),l,new o.Point(i.movementX,i.movementY).divide(e.scale)),u=s[i.button];if("mousemove"===i.type){if(u){if(l.substract(u.startPos).norm()<5)return void(u.lastPos=l);clearTimeout(u.timeout),s[i.button]=null,(null==a?void 0:a.onMouseDown)&&a.onMouseDown(u.mouseDownEvent,n);const t=u.lastPos.substract(u.startPos).divide(e.scale);c.movement=c.movement.add(t),c.cursor=c.cursor.add(t)}(null==a?void 0:a.onMouseMove)&&a.onMouseMove(c,n)}else"mousedown"===i.type?(u&&clearTimeout(u.timeout),s[i.button]={startPos:l,lastPos:l,mouseDownEvent:c,timeout:setTimeout((()=>{const t=s[i.button];if(t){s[i.button]=null,(null==a?void 0:a.onMouseDown)&&a.onMouseDown(t.mouseDownEvent,n);const o=t.lastPos.substract(t.startPos).divide(e.scale);c.movement=o,c.cursor=c.cursor.add(o),(null==a?void 0:a.onMouseMove)&&a.onMouseMove(c,n)}}),750)}):"mouseup"===i.type?u?(clearTimeout(u.timeout),s[i.button]=null,(null==a?void 0:a.onClick)&&a.onClick(c,n)):(null==a?void 0:a.onMouseUp)&&a.onMouseUp(c,n):"mouseleave"===i.type&&(null==a?void 0:a.onMouseLeave)&&a.onMouseLeave(c,n)};return t.addEventListener("wheel",i),t.addEventListener("mousemove",r),t.addEventListener("mousedown",r),t.addEventListener("mouseup",r),t.addEventListener("mouseleave",r),()=>{t.removeEventListener("wheel",i),t.removeEventListener("mousemove",r),t.removeEventListener("mousedown",r),t.removeEventListener("mouseup",r),t.removeEventListener("mouseleave",r)}}),[e,e.areaState.node]),i}},1196:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.synchronizableStates=t.instantiatedStore=void 0,t.instantiatedStore=e=>{const t={};return n=>{let i=t[n];return void 0===i&&(i=e(),t[n]=i),i}};const n={};t.synchronizableStates=e=>(t,i,s)=>{const o=s,r=n;return o.setSync=e=>{e!==o._syncKey&&(o._syncUnsub&&o._syncUnsub(),null!==o._syncKey&&r[o._syncKey].filter((e=>e!==o)),o._syncKey=e,o._syncUnsub=void 0,null!==e&&(e in r?r[e].push(o):r[e]=[o],o._syncUnsub=o.subscribe((t=>{o._syncLock||(o._syncLock=!0,r[e].forEach((e=>{e._syncLock||(e._syncLock=!0,e.setState(t),e._syncLock=!1)})),o._syncLock=!1)}))))},o.getSync=()=>o._syncKey,o._syncKey=null,o._syncUnsub=void 0,o._syncLock=!1,e(t,i,s)}},8657:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MODULE_NAME=t.MODULE_VERSION=void 0;const i=n(4147);t.MODULE_VERSION=i.version,t.MODULE_NAME=i.name},811:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JView2DModel=t.JView2D=void 0,n(7204);var i=n(338);Object.defineProperty(t,"JView2D",{enumerable:!0,get:function(){return i.JView2D}}),Object.defineProperty(t,"JView2DModel",{enumerable:!0,get:function(){return i.JView2DModel}})},9036:(e,t,n)=>{(t=n(3645)(!1)).push([e.id,".ImageViewerWidget{\n    height: 350px;\n    width: 100%;\n}\n\n.jp-LinkedOutputView .ImageViewerWidget{\n    height: 100%;\n}\n\n.ImageViewport{\n    position: relative;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    clip-path: polygon(0% 0%,100% 0%,100% 100%,0% 100%);\n}\n\n.jp-LinkedOutputView .ImageViewport:before {\n\n}\n\n.jp-LinkedOutputView .ImageViewport:before {\n    content: '';\n    position: absolute;\n    left: 0;\n    right: 0;\n    width: calc(100% - 2px);\n    height: calc(100% - 2px);\n    z-index: 4;\n    box-shadow: inset 0 0 2.5em -0.5em #1119;\n    -webkit-box-shadow: inset 0 0 2.5em -0.5em #1119;\n    -moz-box-shadow: inset 0 0 2.5em -0.5em #1119;\n    border: var(--jp-layout-color2) 1px solid;\n}\n\n.undraggable {\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n    -webkit-user-drag: none;\n    user-drag: none;\n    -webkit-touch-callout: none;\n}",""]),e.exports=t},9943:(e,t,n)=>{(t=n(3645)(!1)).push([e.id,".RulerAxis {\n}\n\n.RulerAxis svg{\n    width: 100%;\n    height: 100%;\n    background-color: var(--jp-layout-color2);\n}\n\n.RulerAxis .labelTick line{\n    stroke: var(--jp-inverse-layout-color3);\n    stroke-width: 1px;\n}\n\n.RulerAxis .labelTick text{\n    text-anchor: middle;\n    alignment-baseline: middle;\n    fill: var(--jp-inverse-layout-color3);\n}\n\n.RulerAxis .BoundariesLabelTick text{\n    font-weight: bold;\n}\n\n.RulerAxis .end text{\n    text-anchor: end;\n    font-weight: bold;\n}\n\n.RulerAxis .start text{\n    text-anchor: start;\n    font-weight: bold;\n}\n\n.RulerAxis .tick {\n    stroke: var(--jp-inverse-layout-color4);\n    stroke-width: 1px;\n}\n\n.RulerAxis .cursorTick rect{\n    fill: var(--jp-layout-color3);\n}\n\n.RulerAxis .cursorTick line{\n    stroke: var(--jp-inverse-layout-color2);\n}\n\n.RulerAxis .cursorTick text{\n    fill: var(--jp-inverse-layout-color2);\n    font-weight: bold;\n}\n\n.RulerAxis .out-of-domain {\n    fill: var(--jp-layout-color1);\n}\n\n.RulerAxis .shadow {\n    fill: var(--jp-layout-color1);\n    opacity: 0.7;\n    backdrop-filter: blur(4px);\n}\n\n.RulerAxis .HighlightLabelTick text{\n    strike: var(--jp-inverse-layout-color2);\n}\n\n.RulerAxis #lightBackgroundFilter feFlood{\n    flood-color: var(--jp-layout-color2);\n}\n\n.RulerAxis #darkBackgroundFilter feFlood{\n    flood-color: var(--jp-layout-color1);\n}",""]),e.exports=t},3889:(e,t,n)=>{(t=n(3645)(!1)).push([e.id,".custom-widget {\n  padding: 0px 2px;\n}\n\n.jp-LinkedOutputView .jp-OutputArea-output:only-child {\n  margin: 0;\n}\n\n.jp-LinkedOutputView .maximizing-widget{\n  height: 100%;\n}",""]),e.exports=t},1283:(e,t,n)=>{var i=n(3379),s=n(9036);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.id,s,""]]);i(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},8877:(e,t,n)=>{var i=n(3379),s=n(9943);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.id,s,""]]);i(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},7204:(e,t,n)=>{var i=n(3379),s=n(3889);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.id,s,""]]);i(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},4147:e=>{"use strict";e.exports=JSON.parse('{"name":"jppype","version":"0.1.0","description":"Custom Jupyter Widgets for ProtoPype.","author":{"name":"Gabriel Lepetit-Aimon","email":"gabriel.lepetitaimon@gmail.com"},"license":"BSD-3-Clause","repository":{"type":"git","url":"https://github.com/gabriel-lepetitaimon/jppype.git"},"keywords":["jupyter","jupterlab","widgets","ipython","ipywidgets","jupyterlab-extension"],"main":"lib/index.js","types":"./lib/index.d.ts","files":["lib/**/*.js","dist/*.js","css/*.css"],"scripts":{"legacy-prepublish":"yarn run clean && yarn run build:prod","build":"yarn run build:ts && yarn run build:nbextension:dev && yarn run build:labextension:dev","build:prod":"yarn run build:ts && yarn run build:nbextension && yarn run build:labextension","build:ts":"tsc","build:labextension":"jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True .","build:nbextension":"webpack --mode=production","build:nbextension:dev":"webpack --mode=development","clean":"rimraf lib/ && rimraf dist/ && rimraf ../jppype/labextension/ && rimraf ../jppype/nbextension","watch":"npm-run-all -p watch:*","watch:tsc":"tsc -w","watch:nbextension":"webpack --watch --mode=development","watch:labextension":"jupyter labextension watch --development True .","test":"echo \\"Error: no test specified\\" && exit 1"},"dependencies":{"@emotion/react":"^11.9.0","@emotion/styled":"^11.8.1","@jupyter-widgets/base":"^6","@jupyter-widgets/controls":"^5","@mui/icons-material":"^5.6.2","@mui/material":"^5.7.0","react":"^17.0.2","react-dom":"^17.0.2","rxjs":"^7.5.5","zustand":"^4.0.0-rc.1"},"devDependencies":{"@babel/core":"^7.5.0","@babel/preset-env":"^7.5.0","@babel/preset-react":"^7.14.5","@babel/preset-typescript":"^7.14.5","@jupyterlab/application":"^3.4.3","@jupyterlab/builder":"^3.0.0","@phosphor/application":"^1.6.0","@phosphor/widgets":"^1.6.0","@react-hook/resize-observer":"^1.2.5","@types/react":"^17.0.45","@types/react-dom":"^17.0.16","@types/resize-observer-browser":"^0.1.7","babel-loader":"^8.2.2","css-loader":"^3.2.0","npm-run-all":"^4.1.3","rimraf":"^2.6.1","source-map-loader":"^1.1.3","style-loader":"^1.0.0","ts-loader":"^8.0.0","typescript":"^4.6.4","webpack":"^5"},"babel":{"presets":["@babel/preset-env","@babel/preset-react","@babel/preset-typescript"]},"jupyterlab":{"extension":"lib/labplugin","outputDir":"../jppype/labextension","sharedPackages":{"@jupyter-widgets/base":{"bundled":false,"singleton":true}}}}')}}]);